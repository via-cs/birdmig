\documentclass{article}
\usepackage{graphicx} % Required for inserting images
\usepackage{titlesec}

\title{Visual Analytics of the Impacts of Climate Change on 
Migratory Bird Habitats \\
 \Large{Technical Document}}
\author{Jacob Vogt, Mihika Krishna, Catherine Kang, Hangyul Yun}
\date{June 2024}

\begin{document}

\maketitle

\tableofcontents

\newpage

\section{Introduction}
Our Senior Capstone project is comprised of two components:

\begin{enumerate}
  \item A species distribution model (SDM) capable of predicting how climate change will affect future bird habitats up to year 2100
  \item A web-app that visualizes SDM output and displays other relevant information such as bird migration patterns and climate trends.
\end{enumerate}

This technical document will overview how each of these components work, as well as the required data and file structure for them to operate correctly.

\newpage

\section{Species Distribution Model}

\subsection{R Processing}

\subsubsection*{Libraries}
TODO

\subsubsection*{Input}
TODO

\subsubsection*{Output}
TODO

\subsubsection*{Process}
TODO

\subsection{Model Training}

\subsubsection*{Libraries}
TODO

\subsubsection*{Input}
TODO

\subsubsection*{Output}
TODO

\subsubsection*{Process}
TODO

\subsection{Model Prediction}

\subsubsection*{Libraries}
TODO

\subsubsection*{Input}
TODO

\subsubsection*{Output}
TODO

\subsubsection*{Process}
TODO

\newpage

\section{Web Application}

\subsection{APIs}

\subsubsection*{React}
Reactjs was used to created the frontend, and the main component is found under src/App.js. In App.js, there are calls to the backend to gather data for the various components
located in the src/components folder. In the components folder, there is BirdInfo.js which returns the summary of the desired bird. There are four graphs: ClimateChart.js,
HeatMap.js, PolylineMap.js, and SDMchart.js. Those four files contain the code to display the average temperature and prediction graph, the Trajectory graphs discussed more 
in the Leaflet subsection, and the png of the SDM output. Also in components folder is PredictionControl.js which contains the code to display the year slider and SSP buttons that 
change the Climate and SDM Charts. In addition to the components, the sidebar and header are created in App.js which allows users to view different birds. All the styling is written 
up in src/App.css. 

\subsubsection*{FastAPI}
The middleware and backend of the website was developed using python and FastAPI, in the file base.py located in the subfolder backend/app. The FastAPI backend primarily serves the purpose of quickly retrieving data and sending it to the front end as requested, allowing the front end user-interface to remain lightweight and easy to load quickly. FastAPI was used to build the backend due to its ease in creating end points for a frontend application to call, natively supporting features such as delayed requests and an intuitive way of passing arguments to the FastAPI backend.
The backend is defined predominantly by functions that handle various requests the front end makes in order to retrieve data to display. These functions and their functions are discussed in greater detail in the following section for RestFUL API.

\subsubsection*{RestFUL}
RestFUL API was used to define how the end points were set up, partially due to built-in compatibility with FastAPI, but also due to its simple and intuitive interface. While RestFUL API primarily defines 4 primary methods for GET, PUT, POST, and DELETE, the final application was operational with a stateless backend, meaning only GET and PUT requests were used.
In the file base.py, GET and PUT requests were used to define the following end points:

\begin{itemize}
	\item get\_temperature\_data(): a GET end point that in turn performs a POST request to grid2.rcc-acis.org to obtain temperature data for the state of California throughout a year, which is specified per the user's request.
	\item get\_precipitation\_data(): a GET end point that in turn performs a POST request to grid2.rcc-acis.org to obtain precipitation data for the state of California throughout a year, which is specified per the user's request.
	\item get\_predictions(): a PUT end point that retrieves the pre-computed predictions the Species Distribution Model makes about a specified bird, for a specified year based on specified emission data. While a GET request would have sufficed for its current utility, a PUT request was preferred as this could be expanded to implement a machine learning model to generate predictions dynamically should such a feature be planned in the future.
	\item get\_trajectory\_data(): a GET end point that retrieves a csv file containing the migration trajectory of a specific bird, identified by its unique bird ID, that can be used to generate individual trajectory maps of an individual bird. The trajectory information is discussed later in the subsection for Leaflet.
	\item get\_bird\_ids(): a GET end point that returns all unique bird IDs per a given species. This is used to by the front end component PolylineMap.js to search for a specified bird ID.
	\item get\_heatmap\_data(): a GET end point that retrieves heatmap data of a bird species, to display the aggregated paths of all birds catalogued for that species on the front end with HeatMap.js, as a heat map. This is discussed in further detail in the Leaflet subsection.
\end{itemize}

\subsubsection*{Leaflet}
Leaflet was used to map bird migration patterns in two ways under the "Trajectory" component. The first map, "Individual Path", is created in src/components/PolylineMap.js.
The function fetches data from the csv files under the data folder in backend/app. The function first fetches all the tagged Bird IDs from the csv for the desired bird. Then,
all the trajectories for the first Bird ID are fetched from the backend and drawn on OpenStreetMap using Leaflet.  Arrows are calculated between two points in calculateBearings 
function and added onto the map as well. 
The second map, "Aggregated Path", is created in src/component/HeatMap.js. The function fetches all the latitude and longitude coordinates from the csv of the desired bird in 
the backend/app/data folder. Using Leaflet and the Leaflet plugin, L.heatLayer, a heat layer is generated showing the combined trajectory path of all the tagged birds on top of 
OpenStreetMap layer.  

\subsection{Usage}
Insight into how the website should be used

\subsection{Design}
Insight into how the website was designed

\end{document}
